adr_id: 6
title: "SciML_integration"
status: Draft
date: 2025-03-23
context: |
  The library includes pricing methods based on stochastic differential equations (SDEs), partial differential equations (PDEs), and Monte Carlo simulations.
  Julia's SciML ecosystem, particularly DifferentialEquations.jl, provides highly optimized and extensible infrastructure for solving these problems.

  Many common methods (e.g., Euler–Maruyama, Broadie–Kaya, Crank–Nicolson) could benefit from a unified interface and the robust solver tools provided by SciML.
  Using DifferentialEquations.jl also supports future extensions like adjoint sensitivity analysis, GPU acceleration, and calibration via global optimization packages.

decision: |
  Integrate DifferentialEquations.jl (SciML) as the default backend for:
  - Monte Carlo simulations using `EnsembleProblem`
  - PDE solvers via `ODEProblem` or custom discretizations wrapped in compatible types
  - Stochastic processes via `SDEProblem` or `NoiseProblem`

consequences:
  positive:
    - Unified simulation framework across models
    - Access to high-performance, flexible solvers with adaptive timestepping
    - Compatibility with SciML features (e.g., adjoint sensitivity, GPU, parallel solvers)
    - Reduced maintenance of custom simulation infrastructure
    - A lot less low level code to write
  negative:
    - Added dependency complexity (compile time, versioning)
    - Potential abstraction overhead for simple pricing cases
    - Higher barrier for contributors unfamiliar with SciML APIs
    - Less control over low-level time stepping and memory management

alternatives:
  - name: "Manual simulation loops (custom code per model)"
    pros: "Maximal control, minimal dependencies, tailored performance"
    cons: "Harder to extend, more boilerplate, duplicate logic across models"
  - name: "Lightweight numerical wrappers (e.g., own Euler/FD schemes)"
    pros: "Better control and readability for financial users"
    cons: "No access to SciML ecosystem, harder to support advanced features"

references: []
